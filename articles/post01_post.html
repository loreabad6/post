<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Vector data cube structures • post</title>
<script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Open_Sans-0.4.9/font.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><script src="post01_post_files/libs/quarto-html/popper.min.js"></script><script src="post01_post_files/libs/quarto-html/tippy.umd.min.js"></script><link href="post01_post_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="post01_post_files/libs/quarto-html/light-border.css" rel="stylesheet">
<!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Vector data cube structures">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">post</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/post01_post.html">Vector data cube structures</a></li>
    <li><a class="dropdown-item" href="../articles/post02_geomsum.html">Summarising geometries</a></li>
    <li><a class="dropdown-item" href="../articles/post03_compatibility.html">Compatibility with other packages</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/loreabad6/post" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-quarto">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Vector data cube structures</h1>




      <small class="dont-index">Source: <a href="https://github.com/loreabad6/post/blob/HEAD/vignettes/post01_post.qmd" class="external-link"><code>vignettes/post01_post.qmd</code></a></small>
      <div class="d-none name"><code></code></div>
    </div>






    <p><code>post</code> (POlygon changes in Space and Time) is a package designed to provide array and tabular vector data cube structures to organise and analyse polygons that change their shape in space and time.</p>
<p><code>post</code> takes two existing packages that support vector data cubes: <a href="https://r-spatial.github.io/stars/" class="external-link">stars</a> for array vector data cubes and <a href="https://github.com/huizezhang-sherry/cubble" class="external-link">cubble</a> for tabular vector data cubes. It extends their functionality to support changing geometries and to perform spatio-temporal analyses of vector data.</p>
<p>Particularly, <code>post</code> was created to analyse the evolution of geomorphological features such as landslides, lava flows, and glaciers, which change their geometry over time. However, it can be used to analyse other types of moving and/or changing geometries, for example, urban sprawl.</p>
<section class="level2"><h2 id="vector-data-cubes">Vector data cubes<a class="anchor" aria-label="anchor" href="#vector-data-cubes"></a>
</h2>
<div class="grid">
<div class="g-col-9">
<p>Data cubes are multi-dimensional data structures. The most commonly known data cubes, particularly in Earth observation (EO), are <strong>raster data cubes</strong>. Raster data cubes are structures frequently used to organise time series of satellite imagery, gridded climate data, etc. They have minimum two spatial dimensions: <em>longitude</em> or <em>x</em> and <em>latitude</em> or <em>y</em>. The remainder dimensions can either be <em>time</em>, or other dimension such as <em>bands</em> for EO data.</p>
</div>
<div class="g-col-3">
<p><img src="figs/raster-data-cube.png"></p>
</div>
</div>
<div class="grid">
<div class="g-col-3">
<p><img src="figs/vector-data-cube.png"></p>
</div>
<div class="g-col-9">
<p>On the other hand, <strong>vector data cubes</strong> support one minimum spatial dimension, a <em>geometry</em>. Representing data in vector data cubes becomes useful when thematic variables are changing over time at the vector locations, i.e. for spatio-temporal data. For example, time series of temperature, precipitation, wind speed, etc. recorded by climate stations can be represented and analysed using vector data cubes. However, current implementations of vector data cubes only support static geometries (e.g. climate stations stay at the same place over time). <code>post</code> intends to provide support also for geometries that change over time.</p>
</div>
</div>
</section><section class="level2"><h2 id="post-classes">Post classes<a class="anchor" aria-label="anchor" href="#post-classes"></a>
</h2>
<p>In R, vector data cube structures are supported in the form of array objects by the <a href="https://r-spatial.github.io/stars/" class="external-link">stars</a> package and as tabular objects<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content='&lt;p&gt;Other packages also support spatio-temporal objects such as &lt;a href="https://r-spatial.github.io/sftime/" class="external-link"&gt;sftime&lt;/a&gt;, and further support will be implemented while &lt;code&gt;post&lt;/code&gt; gets developed.&lt;/p&gt;'><sup>1</sup></a> with the <a href="https://github.com/huizezhang-sherry/cubble" class="external-link">cubble</a> package. <a href="https://r-spatial.github.io/sf/" class="external-link">sf</a> is used both by cubble and stars to handle the spatial dimensions. Finally, both stars and cubble support certain <a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a> functions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://loreabad6.github.io/post/">post</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/huizezhang-sherry/cubble" class="external-link">cubble</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/stars/" class="external-link">stars</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-spatial.github.io/sf/" class="external-link">sf</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org" class="external-link">tidyverse</a></span><span class="op">)</span></span></code></pre></div>
</div>
<p><code>post</code> combines the advantages of all these packages to support vector data cubes to structure and analyse polygon geometry time series. For this, two classes are provided: <code>post_array</code> and <code>post_table</code>.</p>
<div>

</div>
<div class="column-page quarto-layout-panel" data-layout="[35,38,27]">
<div class="quarto-layout-row quarto-layout-valign-bottom">
<div class="quarto-layout-cell" style="flex-basis: 35.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="figs/geoms-complete-post.png"></p>
<figcaption>Changing geometries</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 38.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="figs/post_array-vdc.png"></p>
<figcaption><code>post_array</code> class</figcaption></figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 27.0%;justify-content: flex-start;">
<div class="quarto-figure quarto-figure-center">
<figure><p><img src="figs/post_table-vdc.png"></p>
<figcaption><code>post_table</code> class</figcaption></figure>
</div>
</div>
</div>
</div>
<p><code>post_array</code> inherits the <code>stars</code> class and therefore supports most of stars methods, including the print method.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"post_array"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] [             as_post_array as_post_table filter        mutate       </span></span>
<span><span class="co">#&gt;  [6] rename        select        slice         st_as_sf      transmute    </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
</div>
<p><code>post_table</code> inherits the <code>cubble</code> class and its subclasses <code>spatial_cubble_df</code> and <code>temporal_cubble_df</code>. Likewise, it supports most of the cubble methods and retains the cubble print methods.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/methods.html" class="external-link">methods</a></span><span class="op">(</span>class <span class="op">=</span> <span class="st">"post_table"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] arrange            as_post_array      as_post_table      dplyr_reconstruct </span></span>
<span><span class="co">#&gt;  [5] face_spatial       face_temporal      filter             mutate            </span></span>
<span><span class="co">#&gt;  [9] rename             select             slice              spatial           </span></span>
<span><span class="co">#&gt; [13] st_as_sf           st_crs&lt;-           st_normalize       st_shift_longitude</span></span>
<span><span class="co">#&gt; [17] st_transform       st_wrap_dateline   st_zm              unfold            </span></span>
<span><span class="co">#&gt; see '?methods' for accessing help and source code</span></span></code></pre></div>
</div>
</section><section class="level2"><h2 id="creation-and-structure">Creation and structure<a class="anchor" aria-label="anchor" href="#creation-and-structure"></a>
</h2>
<p>To showcase the data structure of post objects a dummy dataset is provided with the package (<code><a href="../reference/polygons.html">?polygons</a></code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">polygons</span></span>
<span><span class="co">#&gt; Simple feature collection with 25 features and 2 fields</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -0.2974337 ymin: -0.00297557 xmax: 0.9730806 ymax: 1.153558</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 10 features:</span></span>
<span><span class="co">#&gt;    gid   datetime                       geometry</span></span>
<span><span class="co">#&gt; 1    a 2020-10-01 POLYGON ((0.5474949 0.80889...</span></span>
<span><span class="co">#&gt; 2    b 2020-10-01 POLYGON ((0.2791708 0.83373...</span></span>
<span><span class="co">#&gt; 3    c 2020-10-01 POLYGON ((0.2807462 0.62779...</span></span>
<span><span class="co">#&gt; 4    d 2020-10-01 POLYGON ((0.7650701 0.47444...</span></span>
<span><span class="co">#&gt; 5    e 2020-10-01 POLYGON ((0.3825692 0.35378...</span></span>
<span><span class="co">#&gt; 6    a 2020-10-02 POLYGON ((0.4961102 0.87283...</span></span>
<span><span class="co">#&gt; 7    b 2020-10-02 POLYGON ((0.3298312 0.76120...</span></span>
<span><span class="co">#&gt; 8    c 2020-10-02 POLYGON ((0.328914 0.568743...</span></span>
<span><span class="co">#&gt; 9    d 2020-10-02 POLYGON ((0.7217233 0.52617...</span></span>
<span><span class="co">#&gt; 10   e 2020-10-02 POLYGON ((0.3101455 0.31689...</span></span></code></pre></div>
</div>
<p>The data has 5 objects with a unique group identifier that changes their shape for different timestamps.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">polygons</span><span class="op">)</span></span></code></pre></div>
<div class="cell-output-display">
<div>
<figure><p><img src="post01_post_files/figure-html/unnamed-chunk-6-1.png" width="816"></p>
</figure>
</div>
</div>
</div>
<p>To create a post object a group identifier (<code>group_id</code>) is always required<a class="footnote-ref" role="doc-noteref" tabindex="0" data-bs-toggle="popover" data-bs-content="&lt;p&gt;Future implementation of &lt;code&gt;post&lt;/code&gt; intends to introduce functions to group features when the group they belong to is unknown.&lt;/p&gt;"><sup>2</sup></a>. This identifier should be unique per feature and within each group there should not exist duplicated timestamps.</p>
<p>Minimally, an sf object that is converted to a post object should have the following columns:</p>
<ol type="1">
<li>a group identifier</li>
<li>a timestamp</li>
<li>changing geometries</li>
</ol>
<p>When converting an sf object to a post object, the necessary arguments are automatically identified if not supplied.</p>
<section class="level3"><h3 id="post_array-objects">
<code>post_array</code> objects<a class="anchor" aria-label="anchor" href="#post_array-objects"></a>
</h3>
<p><code>post_array</code> is a spatio-temporal array data structure that organises polygons that change their shape in space and time. It extends the <code>stars</code> class for vector data cubes to support changing geometries as attributes. The post_array class supports two dimensions: a summary geometry dimension (default name: <code>geom_sum</code>) and a temporal dimension. The summary geometry is a unique geometry per group which summarises the changing shapes of the polygon geometries in the group. To learn more about the data structure of post_array objects see <code><a href="https://r-spatial.github.io/stars/articles/stars4.html" class="external-link">vignette("stars4", package = "stars")</a></code>.</p>
<p>Each array “cell” should have a value. In case a particular summary geometry - temporal dimension combination does not exist, the changing geometry is stored as an empty geometry. This behavior guarantees the dimensionality of the <code>post_array</code> object.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">arr</span> <span class="op">=</span> <span class="fu"><a href="../reference/as_post_array.html">as_post_array</a></span><span class="op">(</span><span class="va">polygons</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 1 attribute</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;          geometry  </span></span>
<span><span class="co">#&gt;  POLYGON      :25  </span></span>
<span><span class="co">#&gt;  epsg:4326    : 0  </span></span>
<span><span class="co">#&gt;  +proj=long...: 0  </span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;          from to     offset  delta refsys point</span></span>
<span><span class="co">#&gt; geom_sum    1  5         NA     NA WGS 84  TRUE</span></span>
<span><span class="co">#&gt; datetime    1  5 2020-10-01 1 days   Date FALSE</span></span>
<span><span class="co">#&gt;                                                            values</span></span>
<span><span class="co">#&gt; geom_sum POINT (0.647816 0.9018588),...,POINT (0.4690683 0.17772)</span></span>
<span><span class="co">#&gt; datetime                                                     NULL</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "post_array" "stars"</span></span></code></pre></div>
</div>
<p>To extract the summary and changing geometries from <code>post_array</code> objects use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># changing geometry</span></span>
<span><span class="va">arr</span><span class="op">$</span><span class="va">geometry</span></span>
<span><span class="co">#&gt; Geometry set for 25 features  [dim: 5 x 5]</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -0.2974337 ymin: -0.00297557 xmax: 0.9730806 ymax: 1.153558</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 5 geometries:</span></span>
<span><span class="co">#&gt; POLYGON ((0.5474949 0.8088912, 0.4874872 0.8838...</span></span>
<span><span class="co">#&gt; POLYGON ((0.2791708 0.8337388, -0.2847997 0.654...</span></span>
<span><span class="co">#&gt; POLYGON ((0.2807462 0.6277986, 0.3325024 0.7215...</span></span>
<span><span class="co">#&gt; POLYGON ((0.7650701 0.4744459, 0.8787185 0.3753...</span></span>
<span><span class="co">#&gt; POLYGON ((0.3825692 0.3537803, 0.5519791 0.3669...</span></span>
<span><span class="co"># summary geometry</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span></span>
<span><span class="co">#&gt; Geometry set for 5 features </span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -0.002543201 ymin: 0.17772 xmax: 0.752585 ymax: 0.9018588</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; POINT (0.647816 0.9018588)</span></span>
<span><span class="co">#&gt; POINT (-0.002543201 0.8403816)</span></span>
<span><span class="co">#&gt; POINT (0.3897167 0.5412363)</span></span>
<span><span class="co">#&gt; POINT (0.752585 0.3538271)</span></span>
<span><span class="co">#&gt; POINT (0.4690683 0.17772)</span></span></code></pre></div>
</div>
<p>The array format does not include the group identifiers in their data structure directly, since they are represented by the summary geometry. However, these identifiers are stored as metadata and can be obtained as:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/utils-post-array.html">get_group_ids</a></span><span class="op">(</span><span class="va">arr</span><span class="op">)</span></span>
<span><span class="co">#&gt;   gid</span></span>
<span><span class="co">#&gt; 1   a</span></span>
<span><span class="co">#&gt; 2   b</span></span>
<span><span class="co">#&gt; 3   c</span></span>
<span><span class="co">#&gt; 4   d</span></span>
<span><span class="co">#&gt; 5   e</span></span></code></pre></div>
</div>
</section><section class="level3"><h3 id="post_table-objects">
<code>post_table</code> objects<a class="anchor" aria-label="anchor" href="#post_table-objects"></a>
</h3>
<p><code>post_table</code> is a spatio-temporal tabular data structure that organises polygons that change their shape in space and time. It extends the <code>cubble_df</code> classes for vector data cubes to support changing geometries in the temporal face of the cube. The post_table geometry for the spatial face of the cube defaults to a column named <code>geom_sum</code>, while the changing geometry provided is passed on to the temporal face of the cube. To learn more about the data structure of post_table objects see <code><a href="https://huizezhang-sherry.github.io/cubble/articles/cb1class.html" class="external-link">vignette("cb1class", package = "cubble")</a></code>.</p>
<p>Contrary to <code>post_array</code> objects, <code>post_table</code> can handle gaps in its data, i.e., not every summary geometry - temporal combination should be present.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">tab</span> <span class="op">=</span> <span class="fu"><a href="../reference/as_post_table.html">as_post_table</a></span><span class="op">(</span><span class="va">polygons</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # cubble:   key: gid [5], index: datetime, nested form, [sf]</span></span>
<span><span class="co">#&gt; # spatial:  [0, 0.18, 0.75, 0.9], WGS 84</span></span>
<span><span class="co">#&gt; # temporal: datetime [date], geometry [POLYGON [°]]</span></span>
<span><span class="co">#&gt;   gid       long   lat                 geom_sum ts          </span></span>
<span><span class="co">#&gt; * &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;              &lt;POINT [°]&gt; &lt;list&gt;      </span></span>
<span><span class="co">#&gt; 1 a      0.648   0.902     (0.647816 0.9018588) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 2 b     -0.00254 0.840 (-0.002543201 0.8403816) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 3 c      0.390   0.541    (0.3897167 0.5412363) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 4 d      0.753   0.354     (0.752585 0.3538271) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 5 e      0.469   0.178      (0.4690683 0.17772) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "post_table"        "spatial_cubble_df" "cubble_df"        </span></span>
<span><span class="co">#&gt; [4] "sf"                "tbl_df"            "tbl"              </span></span>
<span><span class="co">#&gt; [7] "data.frame"</span></span>
<span><span class="op">(</span><span class="va">tab_temp</span> <span class="op">=</span> <span class="fu"><a href="https://huizezhang-sherry.github.io/cubble/reference/face.html" class="external-link">face_temporal</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; # cubble:   key: gid [5], index: datetime, long form</span></span>
<span><span class="co">#&gt; # temporal: 2020-10-01 -- 2020-10-05 [1D], no gaps</span></span>
<span><span class="co">#&gt; # spatial:  long [dbl], lat [dbl], geom_sum [POINT [°]]</span></span>
<span><span class="co">#&gt;    gid   datetime                                                       geometry</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt; &lt;date&gt;                                                    &lt;POLYGON [°]&gt;</span></span>
<span><span class="co">#&gt;  1 a     2020-10-01 ((0.5474949 0.8088912, 0.4874872 0.8838477, 0.5520055 1.032…</span></span>
<span><span class="co">#&gt;  2 a     2020-10-02 ((0.4961102 0.8728385, 0.4361026 0.947795, 0.5006209 1.0966…</span></span>
<span><span class="co">#&gt;  3 a     2020-10-03 ((0.5578801 0.8616378, 0.5623908 1.085448, 0.8520717 0.8981…</span></span>
<span><span class="co">#&gt;  4 a     2020-10-04 ((0.5652241 0.872057, 0.5685463 1.036898, 0.7819022 0.89897…</span></span>
<span><span class="co">#&gt;  5 a     2020-10-05 ((0.6063791 0.8304178, 0.5463715 0.9053744, 0.6108898 1.054…</span></span>
<span><span class="co">#&gt;  6 b     2020-10-01 ((0.2791708 0.8337388, -0.2847997 0.6540191, -0.2825181 0.6…</span></span>
<span><span class="co">#&gt;  7 b     2020-10-02 ((0.3298312 0.7612067, -0.2341393 0.5814869, -0.2318577 0.5…</span></span>
<span><span class="co">#&gt;  8 b     2020-10-03 ((0.3796448 0.767853, -0.1843257 0.5881332, 0.09777458 1.05…</span></span>
<span><span class="co">#&gt;  9 b     2020-10-04 ((0.3642467 0.779727, -0.1182199 0.6259799, 0.1231118 1.026…</span></span>
<span><span class="co">#&gt; 10 b     2020-10-05 ((0.2665368 0.8649996, -0.2974337 0.6852798, -0.2951521 0.6…</span></span>
<span><span class="co">#&gt; # ℹ 15 more rows</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/class.html" class="external-link">class</a></span><span class="op">(</span><span class="va">tab_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "post_table"         "temporal_cubble_df" "cubble_df"         </span></span>
<span><span class="co">#&gt; [4] "sf"                 "tbl_df"             "tbl"               </span></span>
<span><span class="co">#&gt; [7] "data.frame"</span></span></code></pre></div>
</div>
<p>To extract the summary and changing geometries from <code>post_table</code> objects use:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># changing geometry</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">tab</span><span class="op">)</span></span>
<span><span class="co">#&gt; Geometry set for 5 features </span></span>
<span><span class="co">#&gt; Geometry type: POINT</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -0.002543201 ymin: 0.17772 xmax: 0.752585 ymax: 0.9018588</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; POINT (0.647816 0.9018588)</span></span>
<span><span class="co">#&gt; POINT (-0.002543201 0.8403816)</span></span>
<span><span class="co">#&gt; POINT (0.3897167 0.5412363)</span></span>
<span><span class="co">#&gt; POINT (0.752585 0.3538271)</span></span>
<span><span class="co">#&gt; POINT (0.4690683 0.17772)</span></span>
<span><span class="co"># summary geometry</span></span>
<span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">tab_temp</span><span class="op">)</span></span>
<span><span class="co">#&gt; Geometry set for 25 features </span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -0.2974337 ymin: -0.00297557 xmax: 0.9730806 ymax: 1.153558</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 5 geometries:</span></span>
<span><span class="co">#&gt; POLYGON ((0.5474949 0.8088912, 0.4874872 0.8838...</span></span>
<span><span class="co">#&gt; POLYGON ((0.4961102 0.8728385, 0.4361026 0.9477...</span></span>
<span><span class="co">#&gt; POLYGON ((0.5578801 0.8616378, 0.5623908 1.0854...</span></span>
<span><span class="co">#&gt; POLYGON ((0.5652241 0.872057, 0.5685463 1.03689...</span></span>
<span><span class="co">#&gt; POLYGON ((0.6063791 0.8304178, 0.5463715 0.9053...</span></span></code></pre></div>
</div>
</section><section class="level3"><h3 id="conversion-between-post_-objects">Conversion between <code>post_*</code> objects<a class="anchor" aria-label="anchor" href="#conversion-between-post_-objects"></a>
</h3>
<p>The functions <code>as_post_*()</code> can be used to convert objects between from <code>post_table</code> to <code>post_array</code> and viceversa. This is particularly useful when certain methods and operations are only available for one class.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tab</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/as_post_array.html">as_post_array</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 1 attribute</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;          geometry  </span></span>
<span><span class="co">#&gt;  POLYGON      :25  </span></span>
<span><span class="co">#&gt;  epsg:4326    : 0  </span></span>
<span><span class="co">#&gt;  +proj=long...: 0  </span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;          from to     offset  delta refsys point</span></span>
<span><span class="co">#&gt; geom_sum    1  5         NA     NA WGS 84  TRUE</span></span>
<span><span class="co">#&gt; datetime    1  5 2020-10-01 1 days   Date FALSE</span></span>
<span><span class="co">#&gt;                                                            values</span></span>
<span><span class="co">#&gt; geom_sum POINT (0.647816 0.9018588),...,POINT (0.4690683 0.17772)</span></span>
<span><span class="co">#&gt; datetime                                                     NULL</span></span>
<span><span class="va">arr</span> <span class="op">|&gt;</span> <span class="fu"><a href="../reference/as_post_table.html">as_post_table</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # cubble:   key: gid [5], index: datetime, nested form, [sf]</span></span>
<span><span class="co">#&gt; # spatial:  [0, 0.18, 0.75, 0.9], WGS 84</span></span>
<span><span class="co">#&gt; # temporal: datetime [date], geometry [POLYGON [°]]</span></span>
<span><span class="co">#&gt;   gid       long   lat                 geom_sum ts          </span></span>
<span><span class="co">#&gt; * &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt;              &lt;POINT [°]&gt; &lt;list&gt;      </span></span>
<span><span class="co">#&gt; 1 a      0.648   0.902     (0.647816 0.9018588) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 2 b     -0.00254 0.840 (-0.002543201 0.8403816) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 3 c      0.390   0.541    (0.3897167 0.5412363) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 4 d      0.753   0.354     (0.752585 0.3538271) &lt;sf [5 × 2]&gt;</span></span>
<span><span class="co">#&gt; 5 e      0.469   0.178      (0.4690683 0.17772) &lt;sf [5 × 2]&gt;</span></span></code></pre></div>
</div>
<p>For a conversion from <code>post_array</code> to <code>post_table</code> the argument <code>drop_empty</code> is available in case the post_array object has empty geometries. Dropping empty geometries is the default.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">732</span><span class="op">)</span></span>
<span><span class="op">(</span><span class="va">arr_empty</span> <span class="op">=</span> <span class="va">polygons</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">polygons</span><span class="op">)</span>, <span class="fl">13</span><span class="op">)</span>, <span class="op">]</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="../reference/as_post_array.html">as_post_array</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; stars object with 2 dimensions and 1 attribute</span></span>
<span><span class="co">#&gt; attribute(s):</span></span>
<span><span class="co">#&gt;          geometry  </span></span>
<span><span class="co">#&gt;  POLYGON      :25  </span></span>
<span><span class="co">#&gt;  epsg:4326    : 0  </span></span>
<span><span class="co">#&gt;  +proj=long...: 0  </span></span>
<span><span class="co">#&gt; dimension(s):</span></span>
<span><span class="co">#&gt;          from to     offset  delta refsys point</span></span>
<span><span class="co">#&gt; geom_sum    1  5         NA     NA WGS 84  TRUE</span></span>
<span><span class="co">#&gt; datetime    1  5 2020-10-01 1 days   Date FALSE</span></span>
<span><span class="co">#&gt;                                                              values</span></span>
<span><span class="co">#&gt; geom_sum POINT (0.648836 0.8727337),...,POINT (0.4738249 0.1737262)</span></span>
<span><span class="co">#&gt; datetime                                                       NULL</span></span>
<span><span class="va">arr_empty</span><span class="op">$</span><span class="va">geometry</span></span>
<span><span class="co">#&gt; Geometry set for 25 features  (with 12 geometries empty) [dim: 5 x 5]</span></span>
<span><span class="co">#&gt; Geometry type: POLYGON</span></span>
<span><span class="co">#&gt; Dimension:     XY</span></span>
<span><span class="co">#&gt; Bounding box:  xmin: -0.2847997 ymin: -0.00297557 xmax: 0.8416864 ymax: 1.122298</span></span>
<span><span class="co">#&gt; Geodetic CRS:  WGS 84</span></span>
<span><span class="co">#&gt; First 5 geometries:</span></span>
<span><span class="co">#&gt; POLYGON ((0.5474949 0.8088912, 0.4874872 0.8838...</span></span>
<span><span class="co">#&gt; POLYGON ((0.2791708 0.8337388, -0.2847997 0.654...</span></span>
<span><span class="co">#&gt; POLYGON EMPTY</span></span>
<span><span class="co">#&gt; POLYGON EMPTY</span></span>
<span><span class="co">#&gt; POLYGON ((0.3825692 0.3537803, 0.5519791 0.3669...</span></span>
<span></span>
<span><span class="co"># converting to post_table</span></span>
<span><span class="fu"><a href="../reference/as_post_table.html">as_post_table</a></span><span class="op">(</span><span class="va">arr_empty</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://huizezhang-sherry.github.io/cubble/reference/face.html" class="external-link">face_temporal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # cubble:   key: gid [5], index: datetime, long form</span></span>
<span><span class="co">#&gt; # temporal: 2020-10-01 -- 2020-10-05 [1D], has gaps!</span></span>
<span><span class="co">#&gt; # spatial:  long [dbl], lat [dbl], geom_sum [POINT [°]]</span></span>
<span><span class="co">#&gt;    gid   datetime                                                       geometry</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt; &lt;date&gt;                                                    &lt;POLYGON [°]&gt;</span></span>
<span><span class="co">#&gt;  1 a     2020-10-01 ((0.5474949 0.8088912, 0.4874872 0.8838477, 0.5520055 1.032…</span></span>
<span><span class="co">#&gt;  2 a     2020-10-04 ((0.5652241 0.872057, 0.5685463 1.036898, 0.7819022 0.89897…</span></span>
<span><span class="co">#&gt;  3 b     2020-10-01 ((0.2791708 0.8337388, -0.2847997 0.6540191, -0.2825181 0.6…</span></span>
<span><span class="co">#&gt;  4 b     2020-10-02 ((0.3298312 0.7612067, -0.2341393 0.5814869, -0.2318577 0.5…</span></span>
<span><span class="co">#&gt;  5 b     2020-10-03 ((0.3796448 0.767853, -0.1843257 0.5881332, 0.09777458 1.05…</span></span>
<span><span class="co">#&gt;  6 c     2020-10-02 ((0.328914 0.5687438, 0.3806701 0.6624509, 0.5646669 0.5374…</span></span>
<span><span class="co">#&gt;  7 c     2020-10-03 ((0.2897647 0.6168588, 0.3415208 0.710566, 0.5357965 0.4922…</span></span>
<span><span class="co">#&gt;  8 c     2020-10-04 ((0.2930046 0.6546896, 0.3210764 0.7055149, 0.4264484 0.587…</span></span>
<span><span class="co">#&gt;  9 c     2020-10-05 ((0.2145846 0.5285578, 0.2663408 0.6222649, 0.4503375 0.497…</span></span>
<span><span class="co">#&gt; 10 d     2020-10-02 ((0.7217233 0.5261787, 0.8353717 0.4270488, 0.7832953 0.340…</span></span>
<span><span class="co">#&gt; 11 e     2020-10-01 ((0.3825692 0.3537803, 0.5519791 0.3669884, 0.6063218 0.096…</span></span>
<span><span class="co">#&gt; 12 e     2020-10-03 ((0.2813385 0.2544898, 0.4507484 0.2676979, 0.505091 -0.002…</span></span>
<span><span class="co">#&gt; 13 e     2020-10-05 ((0.4750757 0.2620892, 0.6444856 0.2752973, 0.6988282 0.004…</span></span>
<span><span class="fu"><a href="../reference/as_post_table.html">as_post_table</a></span><span class="op">(</span><span class="va">arr_empty</span>, drop_empty <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://huizezhang-sherry.github.io/cubble/reference/face.html" class="external-link">face_temporal</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; # cubble:   key: gid [5], index: datetime, long form</span></span>
<span><span class="co">#&gt; # temporal: 2020-10-01 -- 2020-10-05 [1D], no gaps</span></span>
<span><span class="co">#&gt; # spatial:  long [dbl], lat [dbl], geom_sum [POINT [°]]</span></span>
<span><span class="co">#&gt;    gid   datetime                                                       geometry</span></span>
<span><span class="co">#&gt;  * &lt;chr&gt; &lt;date&gt;                                                    &lt;POLYGON [°]&gt;</span></span>
<span><span class="co">#&gt;  1 a     2020-10-01 ((0.5474949 0.8088912, 0.4874872 0.8838477, 0.5520055 1.032…</span></span>
<span><span class="co">#&gt;  2 a     2020-10-02                                                        EMPTY</span></span>
<span><span class="co">#&gt;  3 a     2020-10-03                                                        EMPTY</span></span>
<span><span class="co">#&gt;  4 a     2020-10-04 ((0.5652241 0.872057, 0.5685463 1.036898, 0.7819022 0.89897…</span></span>
<span><span class="co">#&gt;  5 a     2020-10-05                                                        EMPTY</span></span>
<span><span class="co">#&gt;  6 b     2020-10-01 ((0.2791708 0.8337388, -0.2847997 0.6540191, -0.2825181 0.6…</span></span>
<span><span class="co">#&gt;  7 b     2020-10-02 ((0.3298312 0.7612067, -0.2341393 0.5814869, -0.2318577 0.5…</span></span>
<span><span class="co">#&gt;  8 b     2020-10-03 ((0.3796448 0.767853, -0.1843257 0.5881332, 0.09777458 1.05…</span></span>
<span><span class="co">#&gt;  9 b     2020-10-04                                                        EMPTY</span></span>
<span><span class="co">#&gt; 10 b     2020-10-05                                                        EMPTY</span></span>
<span><span class="co">#&gt; # ℹ 15 more rows</span></span></code></pre></div>
</div>
</section></section><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'light-border',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config);
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script></main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://loreabad6.github.io" class="external-link">Lorena Abad</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
